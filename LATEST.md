Bug fixes, gui enhancements and more enhancements